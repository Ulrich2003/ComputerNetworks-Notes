# 计算机网络

### 三种交换方式

#### 电路交换

电路交换的三个步骤：

- 建立连接（分配通讯资源🔗）
- 通话📞
- 释放连接🔗

##### 优点：

1. 通讯时延小（通电话 ☎️）
2. 有序传输 （不重排）
3. 没有冲突（点到点 📍）
4. 适用范围广
5. 实时性强（通电话 ☎️）
6. 控制简单（不用有复杂算法支撑 🧮）

##### 缺点：

1. 建立连接时间长（等待拨号连接成功🔗）
2. 线路独占，使用效率低 （电话 ☎️）
3. 灵活性差 （单一线路）
4. 难以规格化

#### 分组交换（重点）

![image-20211102103028881](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211102103028881.png)

发送方：构造分组，发送分组

路由器：缓存分组，转发分组

接收方：接收分组，还原报文

##### 优点：

1. 无需建立连接
2. 线路利用率高
3. 简化了存储管理
4. 加速传输⏩
5. 减少出错概率和重发数据量

##### 缺点：

1. 引起了转发时延（要经历存储转发的过程）
2. 需要传输额外的信息量（每个数据块都需要传输**原地址，目的地址**等信息）
3. 对于数据报服务，存在失序，丢失或重复分组的问题；对于虚电路服务，存在呼叫建立，数据传输和虚电路释放三个过程

#### 报文交换

也采用存储转发的方式，但报文交换对报文的大小没有限制，要求转发节点有**比较大**的缓存空间。主要用于早期的电报通讯网，现在基本被分组交换方式取代。

##### 优点：

1. 无需建立连接
2. 动态分配线路
3. 提高线路可靠性
4. 提高线路利用率
5. 提供多目标服务

##### 缺点

1. 引起转发时延长
2. 需要较大的存储空间
3. 需要传输额外的信息量（携带目标地址，源地址等信息）

#### 三种交换方式的对比

只有电路交换需要提前建立好连接🔗

![image-20211102103737991](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211102103737991.png)

### 计算机网络的分类

![image-20211102105036978](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211102105036978.png)

### 计算机网络的性能指标

常用性能指标有8个：

- 速率

  也称为比特率或数据率

  ![image-20211102105625297](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211102105625297.png)

- 带宽

  用来表示网络的通信线路所能传送数据的能力，表示在单位时间内从网络中的某一点到另外一点所能通过的“**最高数据率**”

  常用单位：b/s ( kb/s, Mb/s, Gb/s )

- 吞吐量

  单位时间内通过某个网络（信道，接口）的数据量，受到网络带宽或额定速率的限制🚫

- 时延

  发送时延，传播时延，处理时延（转发过程） 

- 时延带宽积（**传播时延**和带宽的乘积）

- 往返时间（RTT）

  很多时候，因特网上的信息不仅仅是单向传输，而是双向交互

- 利用率

  当某信道的利用率增加时，该信道引起的时延也会迅速增加，因此，**信道利用率并非越高越好**

- 丢包率

  接口丢包率，链路丢包率，路径丢包率，网络丢包率

### 常见的网络体系结构

![image-20211102124309524](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211102124309524.png)

#### OSI体系结构（相对失败）

协议复杂，效率低，层次划分不太合理。

![image-20211203112308227](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211203112308227.png)

#### TCP/IP体系结构

#### 原理体系结构（用于学习）

#### 计算机网络分层的必要性

![image-20211102125938292](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211102125938292.png)

物理层：

- 采用怎样的传输介质 🗼
- 采用怎样的物理接口 🔌
- 采用怎样的信号表示比特0和1📶

数据链路层：

- 如何标识网络中的各主机（主机编址问题，如MAC地址）💻
- 如何从信号表示的一连串比特流中区分出地址和数据
- 如何协调各主机争用总线

网络层：

- 如何标识各网络以及网络中的各主机（网络和主机共同编址问题，如IP地址）🖥
- 路由器如何转发分组，如何进行路由选择 🗃

运输层：

- 如何解决进程之间基于网络的通信问题（收到了来自服务器的分组，那么这些分组要交给QQ处理呢，还是浏览器处理呢）
- 出现传输错误，如何处理

应用层：

- 通过应用进程间的交互来完成特定的网络应用（支持万维网应用的HTTP协议、支持电子邮件的SMTP协议，支持文件传送的FTP协议）📤 

![image-20211108200629725](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211108200629725.png)

![image-20211203113146226](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211203113146226.png)

![image-20211203113811681](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211203113811681.png)

![image-20211203115426023](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211203115426023.png)

#### 专用术语

**实体**： 任何可发送或接收信息的硬件或软件 💾 进程

对等实体： 收发双方**相同层次**中的实体

**协议**：控制两个**对等实体**进行逻辑通讯的规则的集合

协议三要素：

- 语法 ：定义所交换信息的格式。

![image-20211203104525082](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211203104525082.png)

- 语义 ： 定义收发双方所要完成的操作

- 同步 ： 定义收发双方的时序关系

![image-20211203104745240](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211203104745240.png)

**服务** ： 1⃣️ 在协议的控制下，两个对等实体间的逻辑通讯使得本层可以向上一层提供服务 2⃣️ 要实现本层协议，还需要使用下面一层所提供的服务

![image-20211203105128174](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211203105128174.png)

❗️ 协议是水平的，服务是垂直的

⚠️ 实体看见相邻下层所提供的服务，但不知道该服务的具体协议（享受手机带来的服务，不需要关心如何造手机📱）

**对等层数据单元PDU（Protocol Data Unit）**：对等层次之间传送的数据包，称为该层的协议数据单元 

![image-20211203115218659](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211203115218659.png)

**服务数据单元SDU（Service Data Unit）**：同一系统内，层与层之间交换的数据包称为服务数据单元

⚠️ 多个SDU可以合成为一个PUD，一个SDU可以划分为几个PDU

![image-20211203110128860](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211203110128860.png)

 体系结构相关习题：

![image-20211203115542077](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211203115542077.png)

时延相关习题：

1Mb = 1000000 b

加快做题速度的做题技巧：

 ![image-20211203162816333](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211203162816333.png)

习题课视频：https://www.bilibili.com/video/BV1c4411d7jb?p=13

### 物理层的基本概念

![image-20211203164321011](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211203164321011.png)

### 传输媒体（不属于计算机网络体系结构的任何一层）

##### 导引型传输媒体：

- 同轴电缆

- 双绞线

  ![image-20211203164934865](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211203164934865.png)

- 光纤

- 电力线

##### 非导引型传输媒体

- 无线电波
- 微波
- 红外线
- 可见光

### 传输方式

**串行传输**（如用于计算机和远程计算机的传输）

**并行传输**（如用于计算机内部的传输）

![image-20211203170144874](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211203170144874.png)

**同步传输**

**异步传输**

![image-20211203170436250](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211203170436250.png)

**单工**

![image-20211203170535945](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211203170535945.png)

**半双工**

![image-20211203170551758](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211203170551758.png)

**全双工**

![image-20211203170602366](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211203170602366.png)

### 编码与调制

什么是码元？

在使用时间域的波形表示数字信号时 📶，代表不同离散数值的基本波形

![image-20211205185725440](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211205185725440.png)

#### 编码与调制

![image-20211205190030995](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211205190030995.png)

![image-20211205191008306](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211205191008306.png)

**曼彻斯特编码：**

在码元的中间时刻都会发生跳变，中间时刻的跳变既表示时钟，也表示数据

**差分曼彻斯特编码：**

与曼彻斯特编码不同的是：跳变只表示时钟，用码元开始处电平是否发生变化来表示数据

### 信道的极限容量

![image-20211205195552056](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211205195552056.png)

### 数据链路层

![image-20211205210241876](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211205210241876.png)

##### Link链路：

就是从一个结点到相邻节点的一段物理线路，而中间没有其他的交换节点

##### Data Link数据链路：

是指把实现通讯协议的硬件和软件加到链路上，就构成了数据链路

数据链路层以**帧**为单位传输和处理数据

#### 数据链路层的三个重要问题

##### 什么是封装成帧 📦

![image-20211205211235689](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211205211235689.png)

##### 差错检测

发送方在发送帧之前，会把检错码封装到帧尾

##### 可靠传输

### 封装成帧 📦

![image-20211207110642087](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211207110642087.png)

帧头和帧尾中包含有重要的控制信息

帧头和帧尾的作用之一就是**帧定界**

##### 什么是透明传输 ❓

透明传输指的是数据链路层对上层交付的传输数据没有任何限制，就好像数据链路层不存在一样

为了提高帧传输效率，应当使帧的数据部分的长度尽可能长一些

### 差错检测

- 奇偶校验（一般不采用这种方法）

![image-20211207152832662](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211207152832662.png)

- 循环冗余校验CRC ♻️

**检错码**只能检测出帧在传输过程中出现了差错，但并不能定位错误，因此无法纠正错误。

**循环冗余校验CRC**有很好的检错能力，易于用硬件实现，因此广泛应用于**数据链路层**。

### 可靠传输

**比特差错**只是传输差错中的一种

传输差错还包含分组丢失，分组失序以及分组重复

分组丢失，分组失序以及分组重复这些传输差错，一般不会出现在数据链路层，而会出现在其上层 ⬆️

可靠传输服务并不仅局限于数据链路层，其他各层均🉑️选择实现可靠传输

![image-20211207154524486](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211207154524486.png)

#### 可靠传输的实现机制

##### SW （Stop-and-wait）停止等待协议⌛️

![image-20211207160525130](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211207160525130.png)

1⃣️ 接收方检测到数据分组有误码时，将其丢弃并等待发送方的超时等待。对于误码率较高的P2P链路，为了使发送方尽快重传，也可以给发送方发送NAK分组

2⃣️ 为了让接收方判断收到的数据分组是否是重复的，需要给数据分组编号，由于SW协议特性，只需要1比特编号就够了，即0和1

3⃣️ 为了让发送方判断收到的ACK分组是否时重复的，需要给ACK分组编号，也只需要1比特编号，数据链路层一般不会出现ACK分组迟到的情况，因此在数据链路层上实现SW协议可以不用给ACK分组编号

4⃣️ 超时计时器设置的「重传时间」一般略大于「从发送方到接收方的平均往还时间⌚️」

##### SW协议信道利用率

![image-20211207161939955](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211207161939955.png)

##### ❌ SW协议缺点：

当往返时延RTT远大于数据帧发送时延TD时（如使用卫星链路 🛰️），信道利用率将非常低



##### GBN（Go-Back-N）回退  N帧协议

1⃣️ 采用3个比特给分组编序号，即序号0-7

2⃣️ 发送窗 口的尺寸WT的取值

3⃣️ 接收窗口的尺寸WR的取值 WR = 1

![image-20211207165308778](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211207165308778.png)

回退N帧协议的接收窗口尺寸**WR**只能等于1，因此接收方只能按序接收正确到达的数据分组。

一个数据分组的误码会导致其后续多个数据分组不能被接收方按序接收而丢弃（尽管他们🈚️乱序和误码），这样必然会造成发送方对这些数据分组的超时重传，显然会对通讯资源造成极大浪费

##### SR（Selective Request） 选择重传协议

为了进一步提高性能，可设法只重传**出现误码**的数据分组。因此，接收窗口的尺寸WR不应再等于1（而应大于1），**以便接收方先收下失序到达但无误码并且序号落在接收窗口内的那些数据分组**，等到所缺分组收齐后再一并送交上层。

**选择重传协议**为了使发送方仅重传出现差错的分组，接收方不能再采用**累计确认**，而需要对每个正确接收到的数据分组进行**逐一确认**。

![image-20211207182010290](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211207182010290.png)

![image-20211207182046338](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211207182046338.png)

### PPP（Point-to-Point Protocol）点对点协议

![image-20211207184343566](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211207184343566.png)

##### PPP透明传输

![image-20211207184815753](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211207184815753.png)

![image-20211207185138892](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211207185138892.png)

### 媒体接入控制的基本概念

共享信道要着重考虑一个问题就是如何协调多个发送和接收站点对一个共享传输媒体的占用，即**媒体接入控制MAC（Medium Access Control）**

![image-20211207190547173](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211207190547173.png)

#### 信道复用

复用是通讯技术中的一个重要概念，复用就是通过一条物理线路同时传输多路用户的信号 📶

当网络中传输媒体的传输容量大于多条单一信道传输的总通讯量时，可利用复用技术在一条物理线路上建立多条通讯信道来充分利用传输媒体的带宽

![image-20211207194625505](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211207194625505.png)

- 频分复用FDM

![image-20211207194836330](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211207194836330.png)

- 时分复用TDM

![image-20211207194938825](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211207194938825.png)

- 波分复用WDM

![image-20211207195104424](https://vichien-public.oss-cn-guangzhou.aliyuncs.com/typora/image-20211207195104424.png)

- 码分复用CDM

与FDM和TDM不同，CDM的每一个用户可以在同样的频带进行通讯。由于各用户经过特殊挑选的不同码型，因此各用户之间不会造成干扰。

